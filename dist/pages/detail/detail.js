require(["http://localhost:9000/js/conf/config.js"],function(){require(["jquery","optimize","template","ajaxMapping","cookie","parabola","common","carousel","magnifier"],function(a,b,c,d,e,f,g){a(function(){function h(){if(null!=e.getCookie("goods")){var b=JSON.parse(e.getCookie("goods")),c=0;b.forEach(function(a){c+=parseInt(a.count)}),a(".numRed").html(c)}}a(".carousel-content").carousel({carousel:".carousel",indexContainer:".img-index",timing:3e3,animateTime:700,autoPlay:!0,direction:"left"}),g.input(),g.onload(),h(),a(window).on("scroll",b.debounce(function(){850<a(window).scrollTop()?(a(".topNav").css({position:"fixed",zIndex:"9999"}),a(".topNav").animate({top:0},300)):a(".topNav").css({position:""})},100,window)),a("li.close>a").on("click",function(b){b.preventDefault?b.preventDefault():b.returnValue=!1,a(".right-fix").css({display:"none"})}),a(".comment-warp").load("http://localhost:9000/pages/templates/detail.html",function(){var b=new Map;a.ajax({jsonp:"jsoncallback",dataType:"jsonp",url:d.comment,success:function(d){console.log(d),d=d.comBO;d.forEach(function(a,c){b.set(c,{userName:d[c].commentUser.userNick,hasBuy:d[c].commentUser.hasBought,comment:d[c].comment.commentContent,goodsName:d[c].commentProd.prodName,goodsUrl:d[c].commentProd.prodImgUrl}),c++});var e=c("commentTemp",{list:b});a(".comment-warp").html(a(".comment-warp").html()+e)}})}),a(".goodsMes").load("http://localhost:9000/pages/templates/detail.html",function(){var b=new Map,d=window.location.hash,g=d.split("#")[1].split("&")[0],i=d.split("#")[1].split("&")[1];a.ajax({jsonp:"jsoncallback",dataType:"jsonp",url:`http://portal.xiu.com/business/GoodsDetailMainCmd?goodsId=${g}&goodsSn=${i}&sellType=5&_=1537160302533`,success:function(d){function i(c){var d=parseInt(a("#goodsNum").get(0).value),f={id:g,name:b.get(0).goodsName,price:b.get(0).price,color:b.get(0).color,size:b.get(0).size,url:b.get(0).url,brand:b.get(0).brand,count:d,originPrice:b.get(0).originPrice},h=e.getCookie("goods"),i=null;i=null==h?[]:JSON.parse(h);var j=i.some(function(a){var b=a.id==f.id;return b});j||i.push(f),e.setCookie(c,JSON.stringify(i),"/")}var j=d[0].productSkuJson.split(",")[4].substring(11,d[0].productSkuJson.split(",")[4].length-1);b.set(0,{goodsName:d[0].goodsDetailBean.goods.goodsName,dicount:d[0].snProductInfo[0].preferential.detail[0].activityName,time:d[0].snProductInfo[0].deliveryInfoVo.sendDate,area:d[0].snProductInfo[0].deliveryInfoVo.sendAddress,color:d[0].goodsDetailBean.colors[0].attrValue,size:d[0].goodsDetailBean.sizes[0].attrValue,url:j,price:d[0].snProductInfo[0].XPrice,brand:d[0].goodsDetailBean.goods.brandCNName,originPrice:d[0].snProductInfo[0].MPrice});var k=c("goodsDetail",{list:b});a(".goodsMes").html(a(".goodsMes").html()+k);magnifier({magnifier:"#magnifier1",width:402,height:538,zoom:2}),a(".plus").on("click",function(){var b=parseInt(a("#goodsNum").get(0).value);a("#goodsNum").get(0).value=++b}),a(".minus").on("click",function(){var b=parseInt(a("#goodsNum").get(0).value);1<b&&(b=--b),a("#goodsNum").get(0).value=b}),a("a.buy").on("click",function(){i("goods"),window.location.href="http://localhost:9000/pages/shoppingcart/shoppingcart.html"}),a("a.collect").on("click",function(){i("collection")}),a(".addShoppingcart").on("click",function(c){var d=b.get(0).url+"g1_402_536.jpg",e=a("<img src="+d+">");e.appendTo("body"),e.css({width:"50px",height:"50px",position:"fixed",left:c.clientX+"px",top:c.clientY+"px"}),f.parabola(e.get(0),{x:a(".right-fix").get(0).offsetLeft+20,y:a(".right-fix").get(0).offsetHeight+56},function(){e.fadeOut(300),h()}),i("goods")})}})}),a(".goodsList").load("http://localhost:9000/pages/templates/detail.html",function(){var b=new Map;a.ajax({jsonp:"jsoncallback",dataType:"jsonp",url:d.history,success:function(d){d=d[0],d.forEach(function(a,c){b.set(c,{goodsName:d[c].brandName,imgUrl:d[c].imgUrl,goodsTitle:d[c].goodName})});var e=c("history",{list:b});a(".goodsList").html(a(".goodsList").html()+e)}})})})})});